<% content_for :title, "DÃ©monstration Vue Dynamic Mounting" %>

<div class="row mb-4">
  <div class="col">
    <h1>ğŸ¯ SystÃ¨me de Montage Dynamique Vue.js</h1>
    <p class="lead">
      Cette page dÃ©montre comment monter plusieurs applications Vue dynamiquement
      via des <code>data-behavior</code> attributes.
    </p>
  </div>
</div>

<div class="row mb-4">
  <div class="col-md-6 mb-3">
    <h3>Composant Counter (par dÃ©faut)</h3>
    <div data-behavior="vue-counter"></div>
  </div>

  <div class="col-md-6 mb-3">
    <h3>Counter avec props personnalisÃ©es</h3>
    <div
      data-behavior="vue-counter"
      data-title="Mon compteur personnalisÃ©"
      data-initial-count="10"
    ></div>
  </div>
</div>

<div class="row mb-4">
  <div class="col-md-6 mb-3">
    <h3>Composant Greeting</h3>
    <div
      data-behavior="vue-greeting"
      data-name="Jean Dupont"
      data-message="Ceci est un message personnalisÃ© passÃ© via data-attributes !"
    ></div>
  </div>

  <div class="col-md-6 mb-3">
    <h3>Greeting avec valeurs par dÃ©faut</h3>
    <div data-behavior="vue-greeting"></div>
  </div>
</div>

<div class="row mb-4">
  <div class="col-md-8 mb-3">
    <h3>Composant TodoList</h3>
    <div
      data-behavior="vue-todo-list"
      data-title="Mes tÃ¢ches du jour"
      data-initial-todos='["CrÃ©er le systÃ¨me de montage dynamique", "Tester avec plusieurs composants", "DÃ©ployer en production"]'
    ></div>
  </div>

  <div class="col-md-4 mb-3">
    <h3>TodoList vide</h3>
    <div
      data-behavior="vue-todo-list"
      data-title="Liste vide"
    ></div>
  </div>
</div>

<div class="row mb-4">
  <div class="col-md-8 mb-3">
    <h3>Composant TodoList</h3>
    <%test=['test', 'test2', 'test3'] %>
    <div
      data-behavior="vue-todo-list"
      data-title="Mes tÃ¢ches du jour"
      data-initial-todos='<%=test.to_json.html_safe %>'
    ></div>
  </div>

  <div class="col-md-4 mb-3">
    <h3>Counter bis</h3>
    <div
      data-behavior="vue-counter-bis"
    ></div>
  </div>
</div>

<div class="row mb-4">
  <div class="col">
    <h2 class="mb-3">ğŸ“ Composants dans des sous-dossiers</h2>
    <p class="lead">
      Les composants peuvent Ãªtre organisÃ©s dans des sous-dossiers.
      Le chemin est automatiquement inclus dans le nom pour Ã©viter les conflits.
    </p>
  </div>
</div>

<div class="row mb-4">
  <div class="col-md-4 mb-3">
    <h3>Bouton partagÃ©</h3>
    <p><code>shared/Button.vue</code> â†’ <code>vue-shared-button</code></p>
    <div data-behavior="vue-shared-button" data-label="Bouton par dÃ©faut"></div>
    <div class="mt-2">
      <div data-behavior="vue-shared-button" data-label="SuccÃ¨s" data-variant="success" data-size="sm"></div>
    </div>
    <div class="mt-2">
      <div data-behavior="vue-shared-button" data-label="Danger" data-variant="danger" data-size="lg"></div>
    </div>
  </div>

  <div class="col-md-4 mb-3">
    <h3>Alertes partagÃ©es</h3>
    <p><code>shared/Alert.vue</code> â†’ <code>vue-shared-alert</code></p>
    <div data-behavior="vue-shared-alert" data-title="Info" data-message="Ceci est une alerte info" data-type="info"></div>
    <div class="mt-2" data-behavior="vue-shared-alert" data-title="SuccÃ¨s !" data-message="OpÃ©ration rÃ©ussie" data-type="success"></div>
    <div class="mt-2" data-behavior="vue-shared-alert" data-message="Attention !" data-type="warning"></div>
  </div>

  <div class="col-md-4 mb-3">
    <h3>Input de formulaire</h3>
    <p><code>forms/TextInput.vue</code> â†’ <code>vue-forms-text-input</code></p>
    <div data-behavior="vue-forms-text-input" data-label="Nom complet" data-placeholder="Jean Dupont" data-required="true"></div>
    <div data-behavior="vue-forms-text-input" data-label="Email" data-type="email" data-help-text="Nous ne partagerons jamais votre email"></div>
  </div>
</div>

<div class="row mb-4">
  <div class="col">
    <div class="alert alert-success">
      <h5 class="alert-heading">âœ… Pas de conflit de noms !</h5>
      <p class="mb-0">
        Si vous crÃ©ez <code>Button.vue</code> Ã  la racine ET <code>shared/Button.vue</code>,
        ils seront enregistrÃ©s comme <code>vue-button</code> et <code>vue-shared-button</code>.
        Le systÃ¨me inclut automatiquement le chemin du dossier dans le nom !
      </p>
    </div>
  </div>
</div>

<div class="row mb-4">
  <div class="col">
    <div class="card bg-light">
      <div class="card-body">
        <h4 class="card-title">ğŸ”¥ Test de montage dynamique</h4>
        <p class="card-text">
          Cliquez sur le bouton ci-dessous pour ajouter dynamiquement
          un nouveau composant Vue Ã  la page. Le systÃ¨me dÃ©tectera automatiquement
          le nouvel Ã©lÃ©ment et montera l'application !
        </p>
        <button class="btn btn-success" onclick="addDynamicComponent()">
          â• Ajouter un composant dynamiquement
        </button>
        <div id="dynamic-container" class="mt-3"></div>
      </div>
    </div>
  </div>
</div>

<div class="row mb-4">
  <div class="col">
    <div class="card border-info">
      <div class="card-header bg-info text-white">
        <h5 class="mb-0">ğŸ“– Comment Ã§a marche ?</h5>
      </div>
      <div class="card-body">
        <h6>1. Ajouter un composant dans votre HTML :</h6>
        <pre class="bg-dark text-light p-3 rounded"><code>&lt;div data-behavior="vue-counter"&gt;&lt;/div&gt;</code></pre>

        <h6 class="mt-3">2. Passer des props via data-attributes :</h6>
        <pre class="bg-dark text-light p-3 rounded"><code>&lt;div
  data-behavior="vue-greeting"
  data-name="Jean"
  data-message="Bonjour !"
&gt;&lt;/div&gt;</code></pre>

        <h6 class="mt-3">3. Types supportÃ©s :</h6>
        <ul>
          <li><strong>String :</strong> <code>data-name="Jean"</code></li>
          <li><strong>Number :</strong> <code>data-count="42"</code></li>
          <li><strong>Boolean :</strong> <code>data-active="true"</code></li>
          <li><strong>Array/Object (JSON) :</strong> <code>data-items='["a", "b", "c"]'</code></li>
        </ul>

        <h6 class="mt-3">4. Montage automatique :</h6>
        <p>
          Le systÃ¨me utilise un <code>MutationObserver</code> pour dÃ©tecter
          automatiquement les nouveaux Ã©lÃ©ments ajoutÃ©s au DOM, mÃªme via JavaScript
          ou AJAX. Aucune action manuelle nÃ©cessaire !
        </p>
      </div>
    </div>
  </div>
</div>

<script>
  let dynamicCounter = 0;

  function addDynamicComponent() {
    dynamicCounter++;
    const container = document.getElementById('dynamic-container');

    const newElement = document.createElement('div');
    newElement.className = 'mb-3';
    newElement.innerHTML = `
      <div class="alert alert-success">
        <strong>Composant #${dynamicCounter} ajoutÃ© dynamiquement !</strong>
      </div>
      <div
        data-behavior="vue-counter"
        data-title="Compteur dynamique #${dynamicCounter}"
        data-initial-count="${dynamicCounter * 5}"
      ></div>
    `;

    container.appendChild(newElement);
  }
</script>
